{% extends "organization/home-base.html" %}

{% block org_js %}
  <style>
    .course-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .course-item {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      transition: box-shadow 0.3s;
      background: white;
    }

    .course-item:hover {
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .course-image {
      width: 100%;
      height: 150px;
      object-fit: cover;
      border-radius: 4px;
      margin-bottom: 10px;
    }

    .course-name {
      font-size: 1.2em;
      font-weight: bold;
      color: #333;
      text-decoration: none;
      display: block;
      margin-bottom: 10px;
    }

    .course-name:hover {
      color: #0066cc;
    }

    .course-info {
      font-size: 0.9em;
      color: #666;
      margin-top: 5px;
    }

    .course-actions {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid #eee;
    }

    .no-courses {
      text-align: center;
      padding: 40px;
      color: #666;
      background: #f9f9f9;
      border-radius: 8px;
    }

    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .page-title {
      font-size: 1.5em;
      font-weight: bold;
    }
  </style>
{% endblock %}

{% block middle_title %}
  <div class="page-header">
    <div class="page-title">
      {{ _('Courses in %(org)s') % {'org': organization.name} }}
    </div>
    {% if can_create_course %}
      <div>
        <a href="{{ url('course_add') }}" class="action-btn">
          <i class="fa fa-plus"></i> {{ _('Add Course') }}
        </a>
      </div>
    {% endif %}
  </div>
{% endblock %}

{% block middle_content %}
  {% if courses %}
    <div class="course-list">
      {% for course in courses %}
        <div class="course-item">
          {% if course.course_image %}
            <img src="{{ course.course_image.url }}" alt="{{ course.name }}" class="course-image">
          {% else %}
            <div class="course-image" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
          {% endif %}

          <a href="{{ url('course_detail', course.slug) }}" class="course-name">
            {{ course.name }}
          </a>

          <div class="course-info">
            {% set students = course.get_students() %}
            {% set teachers = course.get_teachers() %}

            {% if teachers %}
              <div>
                <i class="fa fa-user-tie"></i>
                {{ _('Teachers') }}: {{ link_users(teachers[:3]) }}
                {% if teachers|length > 3 %}
                  {{ _('and %(count)d more', count=teachers|length - 3) }}
                {% endif %}
              </div>
            {% endif %}

            <div>
              <i class="fa fa-users"></i>
              {{ _('%(count)d students', count=students|length) }}
            </div>

            {% if course.is_open %}
              <div style="color: green; margin-top: 5px;">
                <i class="fa fa-check-circle"></i> {{ _('Open for enrollment') }}
              </div>
            {% else %}
              <div style="color: #666; margin-top: 5px;">
                <i class="fa fa-lock"></i> {{ _('Closed for enrollment') }}
              </div>
            {% endif %}
          </div>

          {% if can_edit or Course.is_editable_by(course, request.profile) %}
            <div class="course-actions">
              <a href="{{ url('course_edit', course.slug) }}"
                 class="action-btn small background-gray">
                <i class="fa fa-edit"></i> {{ _('Edit') }}
              </a>
              <a href="{{ url('course_detail', course.slug) }}"
                 class="action-btn small">
                <i class="fa fa-eye"></i> {{ _('View') }}
              </a>
            </div>
          {% endif %}
        </div>
      {% endfor %}
    </div>

    {% if is_paginated %}
      <div class="bottom-pagination-bar">
        {% include "list-pages.html" %}
      </div>
    {% endif %}
  {% else %}
    <div class="no-courses">
      <h3>{{ _('No courses in this organization yet.') }}</h3>
      {% if can_create_course %}
        <p>{{ _('Create your first course to get started.') }}</p>
        <a href="{{ url('course_add') }}" class="action-btn">
          <i class="fa fa-plus"></i> {{ _('Create Course') }}
        </a>
      {% endif %}
    </div>
  {% endif %}
{% endblock %}